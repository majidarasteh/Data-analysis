# **1. Handling Missing Data — `fillna()`**

To **handle missing data** in a DataFrame, you can use the `.fillna()` method. This function allows you to replace null values (`NaN`) with a specified value, such as a **zero, the mean** of the column, or a forward-filled value from the previous row. For example, `df.fillna(0)` **would replace all missing values in the DataFrame with the number 0.**

### Example

```python
df = df.fillna(0)
print(df)
```

**Output**

```
NaN values replaced with 0
```

Suppose we want to fill the only miss values of the Price column.

**Code Example: Filling with 0**

```python
# Fill missing values in the Price column with a chosen value (e.g., 0)
df['Price'] = df['Price'].fillna(0)
print(df['Price'])
```

**Code Example: Filling with the Mean Value**

```python
# Fill missing values in the Price column with a chosen value (e.g., 0)
df['Price'] = df['Price'].fillna(df['Price'].mean())
```

**Code Example: Filling Multiple Columns with missing values**

```python
df['EngineV'] = df['EngineV'].fillna(df['EngineV'].median())
df['Price']   = df['Price'].fillna(0)
```

### Handling non-numerical missing values

**Code Example: Missing Values in a Single Non-Numerical Column**

Fill missing values in the Model column with "Unknown".

```python
df['Model'] = df['Model'].fillna('Unknown')
```

**Code Example: Fill Missing String Values Using Most Frequent Value (Mode)**

**Often the best choice** for categorical data.

```python
df['Body'] = df['Body'].fillna(df['Body'].mode()[0])
```

**Code Example: Fill Many Categorical Columns With Their Own Mode**

Fill the missing values of all categorical columns of a data frams with their own mode values.

```python
for col in df.select_dtypes(include='object'):
    df[col] = df[col].fillna(df[col].mode()[0])
```

**Print the mode values of each categorical column**

```python
for col in df.select_dtypes(include='object'):
    print(df[col].mode()[0])
```

**output**

```
Volkswagen
sedan
Diesel
yes
E-Class
```

# 2. Add a New Column to a DataFram

## **2.1 Add Column Using Series**
To **add a new column to a DataFrame using a Series**, you can simply **assign the Series to a new column name**. The Series must be the same length as the DataFrame, and its index will automatically align with the DataFrame's index. **For example**, `df['New_Column'] = my_series` will create a new column named '`New_Column`' populated with the values from `my_series`.

**If Series length < DataFrame length → remaining values = NaN.**

### Example

```python
seats = pd.Series([4, 4, 4])
df['Seats'] = seats
print(df['Seats'].head(10))
```

**Output**

```
0    4.0
1    4.0
2    4.0
3    NaN
4    NaN
5    NaN
6    NaN
7    NaN
8    NaN
9    NaN
Name: Seats, dtype: float64
```

## **2.2. Replace NaN in New Column**
After adding a new '`Seats`' column where the Series was shorter than the DataFrame, the **missing values are filled with `NaN`**. We can then **replace these NaN** values in the 'Seats' column using `.fillna(2)`, which will set all the **missing entries to the value 2**.

```python
df['Seats'] = df['Seats'].fillna(2)
print(df['Seats'].head(10))
```

**Output**

```
0    4.0
1    4.0
2    4.0
3    2.0
4    2.0
5    2.0
6    2.0
7    2.0
8    2.0
9    2.0
Name: Seats, dtype: float64
```

## **2.3. Add Column Using Python List**
To add a new column to a DataFrame using a Python list, you can **assign the list directly to a new column name**. The length of the list **must exactly match the number of rows in the DataFrame**; otherwise, **an error will occur**. For example, `df['New_Column'] = my_list` will create the new column and populate it with the values from the list in the order they appear.

**Length of list must match DataFrame length.**

### Example

```python
fuel = [7.5, 6.8, 8.0]
df['Fuel per 100KM'] = fuel
```

**Output**: Since the length of the fuel list **is not equal** to the length of the DataFrame, the code results in a `ValueError`.

## **2.4. Add Column from Other Columns**

You can add a new column to a DataFrame by **performing operations on existing columns**. The new column is created by assigning the result of an expression that references other columns in the DataFrame.

For example, you can create a new column, such as `'Price in Euros'`, by performing an operation on an existing column. For instance, if you have a `'Price'` column in US Dollars and the exchange rate is 0.85, you would use the command `df['Price in Euros'] = df['Price'] * 0.85`. This creates the new column and populates it with the converted values for each row.

```python
# Add a new column 'Price in Euros' by converting from Price (assuming conversion rate 0.85)
df['Price in Euros'] = df['Price'] * 0.85

# View the updated DataFrame
print(df[['Price', 'Price in Euros']].head())
```

**Output**

```
     Price  Price in Euros
0   4200.0          3570.0
1   7900.0          6715.0
2  13300.0         11305.0
3  23000.0         19550.0
4  18300.0         15555.0
```

**In Pandas, you can create a new column by combining values from other columns.**

```python
# Create a new column 'Car Name' by combining Brand and Model
df['Car Name'] = df['Brand'] + ' ' + df['Model']

print(df[['Brand', 'Model', 'Car Name']].head())
```

**Output**

```
           Brand         Model                    Car Name
0            BMW           320                     BMW 320
1  Mercedes-Benz  Sprinter 212  Mercedes-Benz Sprinter 212
2  Mercedes-Benz         S 500         Mercedes-Benz S 500
3           Audi            Q7                     Audi Q7
4         Toyota         Rav 4                Toyota Rav 4
```

# **2.5. Add Column with Same Value**
To add a new column where **every row has the same value**, you can **assign a single value to a new column name**. Pandas will automatically broadcast this value to all rows in the DataFrame. For example, the command `df['Number of wheels'] = 4` will create a new 'Number of wheels' column and fill every row with the number `4`.

```python
df['Number of wheels'] = 4
print(df.head())
```

**Output**

```
           Brand    Price       Body  Mileage  EngineV Engine Type  \
0            BMW   4200.0      sedan      277      2.0      Petrol   
1  Mercedes-Benz   7900.0        van      427      2.9      Diesel   
2  Mercedes-Benz  13300.0      sedan      358      5.0         Gas   
3           Audi  23000.0  crossover      240      4.2      Petrol   
4         Toyota  18300.0  crossover      120      2.0      Petrol   

  Registration  Year         Model  Seats  Price in Euros  \
0          yes  1991           320    4.0          3570.0   
1          yes  1999  Sprinter 212    4.0          6715.0   
2          yes  2003         S 500    4.0         11305.0   
3          yes  2007            Q7    2.0         19550.0   
4          yes  2011         Rav 4    2.0         15555.0   

                     Car Name  Number of wheels  
0                     BMW 320                 4  
1  Mercedes-Benz Sprinter 212                 4  
2         Mercedes-Benz S 500                 4  
3                     Audi Q7                 4  
4                Toyota Rav 4                 4  
```

**Print the column of the Datafram**

```python
print(df.columns)
```

**Output**

```
Index(['Brand', 'Price', 'Body', 'Mileage', 'EngineV', 'Engine Type',
       'Registration', 'Year', 'Model', 'Seats', 'Price in Euros', 'Car Name',
       'Number of wheels'],
      dtype='object')
```

---

# **3. Filtering Rows**

Filtering rows in a DataFrame allows you to **select a subset of data** based on a **specific condition**. This is typically done by placing the conditional statement inside square brackets after the DataFrame. For example, `df[df['Price'] > 10000]` will return all rows where the value in the `'Price'` column is greater than $10,000$.

### Example:

```python
print(df[df['Price']>10000].head())
```

**Output**

```
           Brand     Price       Body  Mileage  EngineV Engine Type  \
2  Mercedes-Benz   13300.0      sedan      358      5.0         Gas   
3           Audi   23000.0  crossover      240      4.2      Petrol   
4         Toyota   18300.0  crossover      120      2.0      Petrol   
5  Mercedes-Benz  199999.0  crossover        0      5.5      Petrol   
7           Audi   14200.0      vagon      200      2.7      Diesel   

  Registration  Year   Model  Seats  Price in Euros              Car Name  \
2          yes  2003   S 500    4.0        11305.00   Mercedes-Benz S 500   
3          yes  2007      Q7    2.0        19550.00               Audi Q7   
4          yes  2011   Rav 4    2.0        15555.00          Toyota Rav 4   
5          yes  2016  GLS 63    2.0       169999.15  Mercedes-Benz GLS 63   
7          yes  2006      A6    2.0        12070.00               Audi A6   

   Number of wheels  
2                 4  
3                 4  
4                 4  
5                 4  
7                 4 
```

### Example: count the number of rows that satisfy the condition

**Using `.len()`**

```python
count = len(df[df['Price'] > 10000])
print(count)
```

**Output**

```
2329
```

**Or using `.sum()`**

```python
count = (df['Price'] > 10000).sum()
print(count
```

**Output**

```
2329
```

**Or using `.count()`**

```python
count = df[df['Price'] > 10000]['Price'].count()
print(count)
```

**Output**

```
2329
```

---

# **4. Deleting a Column Using `drop()`**

To **delete a column from a DataFrame**, use the `drop()` function **with `axis=1`**.
To save changes, you must either use `inplace=True` or assign the result back to the DataFrame.

### **Example withr Reassignment**

```python
df = df.drop('Seats', axis=1)   # Reassignment
print(df.head())
```

**Output**

```
           Brand    Price       Body  Mileage  EngineV Engine Type  \
0            BMW   4200.0      sedan      277      2.0      Petrol   
1  Mercedes-Benz   7900.0        van      427      2.9      Diesel   
2  Mercedes-Benz  13300.0      sedan      358      5.0         Gas   
3           Audi  23000.0  crossover      240      4.2      Petrol   
4         Toyota  18300.0  crossover      120      2.0      Petrol   

  Registration  Year         Model  Price in Euros  \
0          yes  1991           320          3570.0   
1          yes  1999  Sprinter 212          6715.0   
2          yes  2003         S 500         11305.0   
3          yes  2007            Q7         19550.0   
4          yes  2011         Rav 4         15555.0   

                     Car Name  Number of wheels  
0                     BMW 320                 4  
1  Mercedes-Benz Sprinter 212                 4  
2         Mercedes-Benz S 500                 4  
3                     Audi Q7                 4  
4                Toyota Rav 4                 4  
```

### **Example withr `inplace=True`**

```python
df.drop('Seats', axis=1, inplace=True)   # inplace=True saves the change
print(df)
```

---

# **5. The `map()` Function**

`map()` is used to transform the values of a column based on a dictionary or another mapping.

### **Example**

```python
df_2 = pd.DataFrame({'A': [1, 2, 3, 3, 1, 2]})

mapping_dict = {1: 'one', 2: 'two', 3: 'three'}
df_2['Encoded_A'] = df_2['A'].map(mapping_dict)

print(df_2)
```

**Output**

```
   A Encoded_A
0  1       one
1  2       two
2  3     three
3  3     three
4  1       one
5  2       two
```

### **Example: apply a function to **every element** of a DataFrame.**

```python
df2 = pd.DataFrame({
    'X': [1, 2, 3],
    'Y': [4, 5, 6]
})

df2 = df2.map(lambda x: x * 10)
print(df2)
```

### **Output**

```
    X   Y
0  10  40
1  20  50
2  30  60
```

---

# **6. Saving Changes When Using `fillna()`**

`df['Price'].fillna()` does **not** save changes unless:

* You use `inplace=True`, **or**
* You reassign the result to the same column.

### **Example 1: Using reassignment**

```python
df['Price'] = df['Price'].fillna(df['Price'].mean())
print(df)
```

### **Output: Using `inplace=True`**
This will fill the missing values and save the changes directly into the DataFrame **without needing reassignment**.

```python
df['Price'].fillna(df['Price'].mean(), inplace=True)
print(df[df['Price']=='NaN'])
```

**Output**

```
Empty DataFrame
Columns: [Brand, Price, Body, Mileage, EngineV, Engine Type, Registration, Year, Model, Price in Euros, Car Name, Number of wheels]
Index: []
```

---

# **7. Sampling a DataFrame Using `sample()`**

To randomly select a portion of a DataFrame, use `sample()` with the `frac` parameter.

### **Example: Randomaly selects 50% of df**

```python
df_sample = df.sample(frac=0.5)
print("length of sampled data: ", len(df_sample))
print(df_sample.head(2))
```

**Output (Random)**

```
length of sampled data:  2172
           Brand    Price   Body  Mileage  EngineV Engine Type Registration  \
3536  Volkswagen  12000.0  sedan      186      3.2      Petrol          yes   
624          BMW   9400.0  sedan      221      4.4         Gas          yes   

      Year      Model  Price in Euros              Car Name  Number of wheels  
3536  2006  Passat B6         10200.0  Volkswagen Passat B6                 4  
624   2004        745          7990.0               BMW 745                 4 
```

---

# **8. Shuffling a DataFrame Using `sample(frac=1)`**

To shuffle the entire DataFrame, use `sample(frac=1)`.

### **Example: Selects 100% of data randomaly**

```python
df_shuffle = df.sample(frac=1)
print("length of shuffle data: ", len(df_shuffle))
print(df_shuffle.head(2))
```

**Output (Random Order)**

```
length of shuffle data:  4345
     Brand    Price       Body  Mileage  EngineV Engine Type Registration  \
2775   BMW  37500.0  crossover      115      3.0      Diesel          yes   
1642   BMW  37500.0  crossover      110      4.4      Petrol          yes   

      Year Model  Price in Euros  Car Name  Number of wheels  
2775  2008  X5 M         31875.0  BMW X5 M                 4  
1642  2011    X6         31875.0    BMW X6                 4 
```

**After sampling or shuffling, you must reassign the result if you want to save it.**

---


# **9. The `reset_index()` Function**

After shuffling, the **index becomes disordered**. Use `reset_index()` to rebuild the index:

* `drop=True` → removes old index
* `inplace=True` → saves the change

### **Example**

```python
df_shuffled = df.sample(frac=1)
df_shuffled.reset_index(drop=True, inplace=True)
print(df_shuffled)
```

### **Output**

```
           Brand    Price       Body  Mileage  EngineV Engine Type  \
0  Mercedes-Benz  68700.0  crossover      980      3.0      Diesel   
1     Mitsubishi  11999.0  crossover      235      3.0         Gas   
2     Mitsubishi   5850.0      hatch      130      1.3      Petrol   

  Registration  Year         Model  Price in Euros                 Car Name  \
0          yes  2013        GL 350        58395.00     Mercedes-Benz GL 350   
1          yes  2007  Pajero Wagon        10199.15  Mitsubishi Pajero Wagon   
2          yes  2005          Colt         4972.50          Mitsubishi Colt   

   Number of wheels  
0                 4  
1                 4  
2                 4 
```

---

# **10. Summary Table of Pandas Methods**

| **Category**               | **Method / Operation**    | **Description**                              | **Example**                                    | **Output**                |
| -------------------------- | ------------------------- | -------------------------------------------- | ---------------------------------------------- | ------------------------- |
| **Fill Missing Values**    | `fillna(value)`           | Replace NaN with a given value               | `df['Age'].fillna(0)`                          | NaN → 0                   |
|                            | `fillna(df.mean())`       | Fill numeric columns with mean               | `df['Price'].fillna(df['Price'].mean())`       | NaN → mean                |
|                            | `fillna(df.median())`     | Fill numeric columns with median             | `df['EngineV'].fillna(df['EngineV'].median())` | NaN → median              |
|                            | `fillna(df.mode()[0])`    | Fill categorical values with mode            | `df['Body'].fillna(df['Body'].mode()[0])`      | NaN → most frequent       |
|                            | `inplace=True`            | Apply changes directly without reassignment  | `df['A'].fillna(0, inplace=True)`              | DataFrame updated         |
| **Drop Missing Data**      | `dropna()`                | Removes rows with any NaN                    | `df.dropna()`                                  | Returns cleaned DataFrame |
|                            | `dropna(subset=[...])`    | Drop rows where specific columns contain NaN | `df.dropna(subset=['Price'])`                  | Removes only those rows   |
| **Column Creation**        | Assign Series             | Add new column from Series                   | `df['Seats'] = pd.Series([4,4])`               | New column                |
|                            | Assign list               | Add column from list                         | `df['Fuel'] = [7.5, 6.8, 8.0]`                 | New column or error       |
|                            | Constant value            | Assign same value to all rows                | `df['Wheels'] = 4`                             | Column = 4                |
|                            | Column math               | Create column from operations                | `df['Price_EUR'] = df['Price']/0.9`            | New numeric column        |
|                            | String combining          | Combine text columns                         | `df['Full'] = df['Brand'] + " " + df['Model']` | e.g., “BMW 320”           |
| **Column Removal**         | `drop('col', axis=1)`     | Remove a column                              | `df.drop('Seats', axis=1)`                     | Column removed            |
|                            | `inplace=True`            | Remove column permanently                    | `df.drop('Seats', axis=1, inplace=True)`       | DataFrame updated         |
| **Replace Values**         | `replace({old:new})`      | Replace specific values                      | `df['Fuel'].replace('Petrol', 'Gasoline')`     | Values changed            |
| **Filtering Based on NaN** | `df[df['col'].isnull()]`  | Select rows where a column is NaN            | `df[df['Age'].isnull()]`                       | Rows with Age NaN         |
|                            | `df[df['col'].notnull()]` | Select rows where a column is valid          | `df[df['Age'].notnull()]`                      | Rows without NaN          |
| **Column Renaming**        | `df.rename()`             | Rename one or more columns                   | `df.rename({'Price':'Price_USD'}, axis=1)`     | Updated column names      |

