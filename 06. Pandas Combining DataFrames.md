# **Combining DataFrames (concat, merge, pivot, crosstab)**


# **1. `concat()` — Combine DataFrames Vertically or Horizontally**

`concat()` stacks DataFrames:

* **axis=0** → vertical (add rows)
* **axis=1** → horizontal (add columns)

---

## **Example 1 — Vertical Concatenation**

```python
df1 = pd.DataFrame({
    "ID": [1, 2],
    "Name": ["Ali", "Sara"]
})

df2 = pd.DataFrame({
    "ID": [3, 4],
    "Name": ["Reza", "Mina"]
})

new_df = pd.concat([df1, df2], axis=0)
print(new_df)
```

### **Output**

```
   ID  Name
0   1   Ali
1   2  Sara
0   3  Reza
1   4  Mina
```

---

## **Example 2 — Horizontal Concatenation**

```python
dfA = pd.DataFrame({"A": [1, 2]})
dfB = pd.DataFrame({"B": ["x", "y"]})

combined = pd.concat([dfA, dfB], axis=1)
print(combined)
```

### **Output**

```
   A  B
0  1  x
1  2  y
```

---

# **2. `merge()` — SQL-Style Join Between DataFrames**

`merge()` joins DataFrames based on matching values in one or more columns.

## **Example — Inner Join**

```python
df1 = pd.DataFrame({
    "ID": [1, 2, 3],
    "Name": ["Ali", "Sara", "Reza"]
})

df2 = pd.DataFrame({
    "ID": [1, 2, 4],
    "Salary": [5000, 6000, 7000]
})

result = pd.merge(df1, df2, on="ID", how="inner")
print(result)
```

### **Output**

```
   ID  Name  Salary
0   1   Ali    5000
1   2  Sara    6000
```

---

## **Example — Left Join**

```python
result = df1.merge(df2, how="left", on="ID")
print(result)
```

### **Output**

```
   ID  Name  Salary
0   1   Ali  5000.0
1   2  Sara  6000.0
2   3  Reza     NaN
```

---

# **3. `pivot()` — Convert Long Data to Wide Format**

`pivot()` turns unique values in columns into **new columns**, reshaping the DataFrame.


## **Example**

```python
sales = pd.DataFrame({
    "Employee": ["Ali", "Ali", "Sara", "Sara"],
    "Month": ["Jan", "Feb", "Jan", "Feb"],
    "Sales": [100, 150, 200, 300]
})

pivot_df = sales.pivot(index="Employee", columns="Month", values="Sales")
print(pivot_df)
```

### **Output**

```
Month     Feb  Jan
Employee           
Ali       150  100
Sara      300  200
```

> Pivot requires **unique (index, column)** pairs.
> If duplicates exist → use `pivot_table()` instead.

---

# **4. `crosstab()` — Frequency Table Between Two Columns**

`crosstab()` counts occurrences of combinations of two columns.
Useful for statistics, classification, and category analysis.

---

## **Example**

```python
df = pd.DataFrame({
    "Department": ["IT", "IT", "HR", "HR", "HR"],
    "Gender": ["M", "F", "F", "M", "F"]
})

cross = pd.crosstab(df["Department"], df["Gender"])
print(cross)
```

### **Output**

```
Gender      F  M
Department      
HR          2  1
IT          1  1
```

---

# **Summary Table — Combining DataFrames**

| **Method / Concept**     | **Description**                                                          | **Example**                                                   | **Output**                              |
| ------------------------ | ------------------------------------------------------------------------ | ------------------------------------------------------------- | --------------------------------------- |
| **`pd.concat()`**        | Combines DataFrames **vertically or horizontally** without matching keys | `pd.concat([df1, df2], axis=0)`                               | Rows appended; index preserved or reset |
| **`pd.concat(axis=1)`**  | Horizontal concatenation                                                 | `pd.concat([df1, df2], axis=1)`                               | Columns placed side-by-side             |
| **`merge()`**            | SQL-style join using a shared key column                                 | `df1.merge(df2, on="ID")`                                     | Matches rows by ID                      |
| **`merge(how="left")`**  | Keeps all rows from left DataFrame                                       | `df1.merge(df2, on="ID", how="left")`                         | Unmatched rows get NaN                  |
| **`merge(how="right")`** | Keeps all rows from right                                                | `df1.merge(df2, on="ID", how="right")`                        | Unmatched rows get NaN                  |
| **`merge(how="outer")`** | Union of both DataFrames                                                 | `df1.merge(df2, on="ID", how="outer")`                        | All rows preserved                      |
| **`merge(how="inner")`** | Intersection join                                                        | `df1.merge(df2, on="ID", how="inner")`                        | Only matching rows                      |
| **`pivot()`**            | Reshape data: rows → columns                                             | `df.pivot(index="Name", columns="Year", values="Score")`      | A new table with columns for each year  |
| **`pivot_table()`**      | Pivot with aggregation                                                   | `df.pivot_table(index="City", values="Sales", aggfunc="sum")` | Summed sales per city                   |
| **`crosstab()`**         | Frequency table between two categories                                   | `pd.crosstab(df["Gender"], df["Result"])`                     | Counts of category combinations         |
