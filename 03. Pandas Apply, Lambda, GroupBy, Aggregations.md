
# **Apply, Lambda, GroupBy, Aggregations**

This section focuses on **row-wise and column-wise operations**, **custom computations**, and **group-based analysis** in Pandas.


# **1. `apply()` — Apply a Function to a Column or Row**


`apply()` lets you apply a function (built-in or custom) to each value in a **Series** or each row/column in a **DataFrame**.

### Example

```python
import pandas as pd

data = {
    "Department": ["IT", "IT", "HR", "HR", "Finance"],
    "Employee": ["Ali", "Sara", "Reza", "Mina", "Sina"],
    "Gender": ["Male", "Female", "Male", "Female", "Male"],
    "Salary": [5000, 6000, 4000, 4500, 7000]
}
df = pd.DataFrame(data)
print(df)
```

**Output**

```
  Department Employee  Gender  Salary
0         IT      Ali    Male    5000
1         IT     Sara  Female    6000
2         HR     Reza    Male    4000
3         HR     Mina  Female    4500
4    Finance     Sina    Male    7000
```

### **Column-wise Example**

```python
df["Salary_After_Tax"] = df["Salary"].apply(lambda x: x * 0.9)
print(df)
```

**Output**

```
  Department Employee  Gender  Salary  Salary_After_Tax
0         IT      Ali    Male    5000            4500.0
1         IT     Sara  Female    6000            5400.0
2         HR     Reza    Male    4000            3600.0
3         HR     Mina  Female    4500            4050.0
4    Finance     Sina    Male    7000            6300.0
```

### **Row-wise Example**

```python
df["Department_Employee"] = df.apply(lambda row: row["Department"] + " " + row["Employee"], axis=1)
print(df)```

**Output**

```
  Department Employee  Gender  Salary  Salary_After_Tax Department_Employee
0         IT      Ali    Male    5000            4500.0              IT Ali
1         IT     Sara  Female    6000            5400.0             IT Sara
2         HR     Reza    Male    4000            3600.0             HR Reza
3         HR     Mina  Female    4500            4050.0             HR Mina
4    Finance     Sina    Male    7000            6300.0        Finance Sina
```

### **Key Point**

* `axis=0` → apply on columns
* `axis=1` → apply on rows

---

# 2. `lambda` — Anonymous (Inline) Function**

`lambda` defines a small, unnamed function for one-time use.

* Useful inside `apply()`, `agg()`, and `groupby()`.

### Example: 

```python
df["Salary_in_Euros"] = df["Salary"].apply(lambda x: x * 0.85)
print(df)
```

**Output**

```
  Department Employee  Gender  Salary  Salary_After_Tax Department_Employee  \
0         IT      Ali    Male    5000            4500.0              IT Ali   
1         IT     Sara  Female    6000            5400.0             IT Sara   
2         HR     Reza    Male    4000            3600.0             HR Reza   
3         HR     Mina  Female    4500            4050.0             HR Mina   
4    Finance     Sina    Male    7000            6300.0        Finance Sina   

   Salary_in_Euros  
0           4250.0  
1           5100.0  
2           3400.0  
3           3825.0  
4           5950.0 
```

---

# **3. `groupby()` — Group Data by One or More Columns**

`groupby()` splits the DataFrame into groups based on a key (one or multiple columns).

### **Basic Example**

Group salaries by department:

```python
df.groupby("Department")["Salary"].mean()
```

**Output**

```
Finance    7000.0
HR         4250.0
IT         5500.0
Name: Salary, dtype: float64
```

### **Multiple Columns**

```python
df.groupby(["Department", "Gender"])["Salary"].mean()
print(df)
```

**Output**

```
Department  Gender
Finance     Male      7000.0
HR          Female    4500.0
            Male      4000.0
IT          Female    6000.0
            Male      5000.0
Name: Salary, dtype: float64
```

---

# **4. Group Aggregations (`agg`)**

`agg()` allows applying **multiple functions** to one or more columns.

### **Example: Multiple Aggregations**

```python
df.groupby("Department")["Salary"].agg(["min", "max", "mean"])
```

**Output**

```
	           min	max	mean
Department			
Finance    	7000	7000	7000.0
HR	        4000	4500	4250.0
IT	        5000	6000	5500.0

```

### **Example: Custom Aggregation with Lambda**

```python
df.groupby("Department")["Salary"].agg([
    "min",
    "max",
    "mean",
    lambda x: x.max() - x.min()
])
```

**Output**

```
	           min	max	mean	<lambda_0>
Department				
Finance	     7000	7000	7000.0	0
HR	         4000	4500	4250.0	500
IT	         5000	6000	5500.0	1000
```

---

# **Summary**

| Concept     | Description                                   | Example               |
| ----------- | --------------------------------------------- | --------------------- |
| `apply()`   | Apply a function to Series or DataFrame rows  | `df["X"].apply(func)` |
| `lambda`    | Inline function for custom logic              | `lambda x: x * 2`     |
| `groupby()` | Group rows by one or more columns             | `df.groupby("Dept")`  |
| `agg()`     | Apply multiple functions (built-in or custom) | `agg(["min", "max"])` |
