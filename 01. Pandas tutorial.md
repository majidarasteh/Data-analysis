# **Pandas Tutorial** 

# **1. What is Pandas?**

**Description:**
Pandas is an open-source Python library providing fast, flexible, and easy-to-use data structures and data analysis tools.

It is widely used in data science, machine learning, preprocessing, and data cleaning.

**Advantages of Pandas:**

* Easy to use
* **Integrates** well with NumPy, Matplotlib, Scikit-Learn
* Ideal for **preparing raw data** for machine learning
* Can read/write many data formats (**CSV, Excel, TSV, etc.**)

---


# **2. Installing Pandas**

### **Using pip**

```
pip install pandas
```

### **Using Anaconda**

```
conda install pandas
```

---

# **3. Pandas Data Structures**

**Description:**
Pandas has two main data structures: **Series** (1D) and **DataFrame** (2D).

### **3.1 Series (1-Dimensional)**

**Short description:**
A labeled one-dimensional array.

* Mutable data values
* Fixed size
* Index starts from 0

### **Code Example 1**

```python
import pandas as pd
s = pd.Series([10, 20, 30])
print(s)
```

**Output**

```
0    10
1    20
2    30
dtype: int64
```

### **Code Example 2**

```python
import pandas as pd

# Create a simple Series with string values
names = pd.Series(["Alice", "Bob", "Charlie"])

print(names)
```

**Output**

```
0       Alice
1         Bob
2    Charlie
dtype: object
```

### **Code Example 3**

```python
import pandas as pd

# Create a simple Series with mixed data
names = pd.Series(["Alice", "Bob", "Charlie", 1, 2, 3])

print(names)
```

**Output**

```
0      Alice
1        Bob
2    Charlie
3          1
4          2
5          3
dtype: object
```

---

### **3.2 DataFrame (2-Dimensional)**

**Short description:**
A **table-like structure** consisting of multiple Series objects (columns). **Similar to Excel** spreadsheets.

### **Code Example 1**

```python
df = pd.DataFrame({
    'Name': ['A', 'B', 'C'],
    'Age': [20, 25, 30]
})
print(df)
```

**Output**

```
  Name  Age
0    A   20
1    B   25
2    C   30
```

You can combine multiple Series into one DataFrame.

### **Code Example 2**

```python
s1 = pd.Series(['BMW', 'Toyota', 'Honda'])
s2 = pd.Series([2019, 2020, 2021])

df = pd.DataFrame({'Car': s1, 'Year': s2})
print(df)
```

**Output**

```
      Car  Year
0     BMW  2019
1  Toyota  2020
2   Honda  2021
```

---

# **4. Loading Data with Pandas**

**Description:**
Pandas supports reading CSV, Excel, TSV, and more.


## **4.1 Read CSV File — `read_csv()`**

**Method description:**
Reads CSV files into a DataFrame.

### **Code Example**

```python
import pandas as pd

df = pd.read_csv(r'C:\Users\Majid\Downloads\Data analysis\cars.csv')
print(df.head())
```

**Output (example)**

```
           Brand    Price       Body  Mileage  EngineV Engine Type  \
0            BMW   4200.0      sedan      277      2.0      Petrol   
1  Mercedes-Benz   7900.0        van      427      2.9      Diesel   
2  Mercedes-Benz  13300.0      sedan      358      5.0         Gas   
3           Audi  23000.0  crossover      240      4.2      Petrol   
4         Toyota  18300.0  crossover      120      2.0      Petrol   

  Registration  Year         Model  
0          yes  1991           320  
1          yes  1999  Sprinter 212  
2          yes  2003         S 500  
3          yes  2007            Q7  
4          yes  2011         Rav 4 
```

---

# **5. Structure of a DataFrame**

**Description:**

* **Rows** → `axis=0`
* **Columns** → `axis=1`
* Leftmost column → index
* First row → column names

  <img width="963" height="378" alt="image" src="https://github.com/user-attachments/assets/084d2d9c-8f16-483a-949e-d56267077adb" />

---

# **6. Export DataFrame — `to_csv()`**
If you want to save a DataFrame as a CSV file, you can use the following code:

### Example

```python
df.to_csv(r'C:\Users\Majid\Downloads\Data analysis\exported_cars.csv')
```

**What the code does:**
* Exports the entire DataFrame
* Includes column names
* **Includes index numbers (0, 1, 2, …) by default****
* Creates the CSV file if it does not already exist
* Overwrites it if it does

---

# **7. Reloading an Exported DataFrame - Using `read_csv()`**

You can reload the saved `exported_cars.csv` file again by the following code:

```python
df_loaded = pd.read_csv(r'C:\Users\Majid\Downloads\Data analysis\exported_cars.csv')
print(df_loaded)
```

**Output**

```
   Unnamed: 0          Brand    Price       Body  Mileage  EngineV  \
0           0            BMW   4200.0      sedan      277      2.0   
1           1  Mercedes-Benz   7900.0        van      427      2.9   
2           2  Mercedes-Benz  13300.0      sedan      358      5.0   
3           3           Audi  23000.0  crossover      240      4.2   
4           4         Toyota  18300.0  crossover      120      2.0   

  Engine Type Registration  Year         Model  
0      Petrol          yes  1991           320  
1      Diesel          yes  1999  Sprinter 212  
2         Gas          yes  2003         S 500  
3      Petrol          yes  2007            Q7  
4      Petrol          yes  2011         Rav 4 
```

As you can see an **additional `Unnamed` column appears**. This happens because the **original CSV file was saved with its index column included**. When Pandas loads the file, it reads that index as regular data and then automatically adds a new index column beside it. **To prevent this**, you can save the DataFrame without its index.

---

# **8. Export Without Index**

When the `.csv` file is **loaded again**, you may notice an extra column named _Unnamed_.

✔️ If you want to **save it without index**, use the following code:

```python
df.to_csv(r'C:\Users\Majid\Downloads\Data analysis\exported_cars.csv', index=False)
```

If you reload the newly saved `CSV` file and check its contents, you will no longer see the extra *Unnamed* column.

```python
df_loaded = pd.read_csv(r'C:\Users\Majid\Downloads\Data analysis\exported_cars.csv')
print(df_loaded.head())
```

**Output**

```
           Brand    Price       Body  Mileage  EngineV Engine Type  \
0            BMW   4200.0      sedan      277      2.0      Petrol   
1  Mercedes-Benz   7900.0        van      427      2.9      Diesel   
2  Mercedes-Benz  13300.0      sedan      358      5.0         Gas   
3           Audi  23000.0  crossover      240      4.2      Petrol   
4         Toyota  18300.0  crossover      120      2.0      Petrol   

  Registration  Year         Model  
0          yes  1991           320  
1          yes  1999  Sprinter 212  
2          yes  2003         S 500  
3          yes  2007            Q7  
4          yes  2011         Rav 4  
```
---

# **9. Accessing DataFrame Attributes and Methods**

Assume we have a **DataFrame such as cars**. To **access a property or a method** of that DataFrame, we can use a dot `.`. **Properties do not use parentheses**, whereas after the name of a method, an opening and closing parenthesis are placed. 

### **9.1 data types of a data frame — `dtypes`**
To view the data type, `dtypes` is used.

```python
print(df.dtypes)
```

**Output**
```
Brand            object
Price           float64
Body             object
Mileage           int64
EngineV         float64
Engine Type      object
Registration     object
Year              int64
Model            object
dtype: object
```

### **9.2 Columns — `columns`**

To see the columns of a data frame, you can use the `.columns` attribute.


```python
print(df.columns)
```

Output example:

```
Index(['Brand', 'Price', 'Body', 'Mileage', 'EngineV', 'Engine Type',
       'Registration', 'Year', 'Model'],
      dtype='object')
```

### **9.3 Index — `index`**
To see the indexes of a data frame, you can use the `.index` attribute. This command will return the row labels for the data frame, allowing you to inspect the index range and its values.

```python
print(df.index)
```

Output:

```
RangeIndex(start=0, stop=4345, step=1)
```

## **9.4. DataFrame Information — `info()`**
To see the information of a data frame, you can use the `.info()` method. This method provides a concise **summary of the data frame**, including the **number of entries, the column names and their data types, and the amount of non-null values in each column**.

### Code Example

```python
print(df.info())
```

**Output (example)**

```
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 4345 entries, 0 to 4344
Data columns (total 9 columns):
 #   Column        Non-Null Count  Dtype  
---  ------        --------------  -----  
 0   Brand         4345 non-null   object 
 1   Price         4173 non-null   float64
 2   Body          4345 non-null   object 
 3   Mileage       4345 non-null   int64  
 4   EngineV       4195 non-null   float64
 5   Engine Type   4345 non-null   object 
 6   Registration  4345 non-null   object 
 7   Year          4345 non-null   int64  
 8   Model         4345 non-null   object 
dtypes: float64(2), int64(2), object(5)
memory usage: 305.6+ KB
None
...
```

## **9.5. Descriptive Statistics — `describe()`**

To see the **descriptive statistics of a data frame**, you can use the `.describe()` method. This method provides a **statistical summary for numerical columns**, typically including **count, mean, standard deviation, minimum, maximum, and quartile values**, giving you a **quick overview of the data's distribution**.

### Example

```python
print(df.describe())
```

Output example:

```
               Price      Mileage      EngineV         Year
count    4173.000000  4345.000000  4195.000000  4345.000000
mean    19418.746935   161.237284     2.790734  2006.550058
std     25584.242620   105.705797     5.066437     6.719097
min       600.000000     0.000000     0.600000  1969.000000
25%      6999.000000    86.000000     1.800000  2003.000000
50%     11500.000000   155.000000     2.200000  2008.000000
75%     21700.000000   230.000000     3.000000  2012.000000
max    300000.000000   980.000000    99.990000  2016.000000
```

# **9.6 View Top Rows — `head()`**

To see the **first few rows of a data frame**, you can use the `.head()` method. By **default, it returns the first five rows**, providing a quick preview of your dataset's structure and values.

### Example

```python
df.head()
```

**Output: first 5 rows**


### Example — Show top 7 rows

```python
df.head(7)
```

**Output: first 7 rows**

```
           Brand     Price       Body  Mileage  EngineV Engine Type  \
0            BMW    4200.0      sedan      277      2.0      Petrol   
1  Mercedes-Benz    7900.0        van      427      2.9      Diesel   
2  Mercedes-Benz   13300.0      sedan      358      5.0         Gas   
3           Audi   23000.0  crossover      240      4.2      Petrol   
4         Toyota   18300.0  crossover      120      2.0      Petrol   
5  Mercedes-Benz  199999.0  crossover        0      5.5      Petrol   
6            BMW    6100.0      sedan      438      2.0         Gas   

  Registration  Year         Model  
0          yes  1991           320  
1          yes  1999  Sprinter 212  
2          yes  2003         S 500  
3          yes  2007            Q7  
4          yes  2011         Rav 4  
5          yes  2016        GLS 63  
6          yes  1997           320
```


# **9.7. View Bottom Rows — `tail()`**

To see the **last few rows of a data frame**, you can use the `.tail()` method. **By default, it returns the last five rows**, which is useful for quickly inspecting the end of your dataset.

### Example

```python
df.tail()
```

### Example — show last 3:

```python
df.tail(3)
```

**Output**

```
print(df.tail(3))
           Brand    Price   Body  Mileage  EngineV Engine Type Registration  \
4342         BMW   8000.0  sedan      194      2.0      Petrol          yes   
4343      Toyota  14200.0  sedan       31      NaN      Petrol          yes   
4344  Volkswagen  13500.0    van      124      2.0      Diesel          yes   

      Year              Model  
4342  1985                520  
4343  2014            Corolla  
4344  2013  T5 (Transporter)  
```

## **9.8. Selecting Columns**

To select a single column from a DataFrame, you can use square brackets, such as `df['Price']. Alternatively, **if the column name has no spaces and does not conflict with an existing DataFrame method**, you can use the `dot` **notation**, like df.Price. Both methods will return the selected column as a Pandas Series.

### **9.8.1 Select Column - using square brackets `[]`**

```python
df['Price'].head()
```

**Output**

```
0     4200.0
1     7900.0
2    13300.0
3    23000.0
4    18300.0
Name: Price, dtype: float64
```

### **9.8.2. Select Column - using dot notation `.`**

```python
df.Price.head()
```

**Output**

```
0     4200.0
1     7900.0
2    13300.0
3    23000.0
4    18300.0
Name: Price, dtype: float64
```

### **9.8.3. Select Multiple Columns**

**Pass a list of column names** inside the brackets.

```python
df[['Price', 'Price in Euros']].head()
```

**Output**

```
	Price	Price in Euros
0	4200.0	3570.0
1	7900.0	6715.0
2	13300.0	11305.0
3	23000.0	19550.0
4	18300.0	15555.0
```

# **9.9. Handling Missing Data — `fillna()`**

To **handle missing data** in a DataFrame, you can use the `.fillna()` method. This function allows you to replace null values (`NaN`) with a specified value, such as a **zero, the mean** of the column, or a forward-filled value from the previous row. For example, `df.fillna(0)` **would replace all missing values in the DataFrame with the number 0.**

### Example

```python
df = df.fillna(0)
print(df)
```

**Output**

```
NaN values replaced with 0
```

Suppose we want to fill the only miss values of the Price column.

**Code Example: Filling with 0**

```python
# Fill missing values in the Price column with a chosen value (e.g., 0)
df['Price'] = df['Price'].fillna(0)
print(df['Price'])
```

**Code Example: Filling with the Mean Value**

```python
# Fill missing values in the Price column with a chosen value (e.g., 0)
df['Price'] = df['Price'].fillna(df['Price'].mean())
```

**Code Example: Filling Multiple Columns with missing values**

```python
df['EngineV'] = df['EngineV'].fillna(df['EngineV'].median())
df['Price']   = df['Price'].fillna(0)
```

### Handling non-numerical missing values

**Code Example: Missing Values in a Single Non-Numerical Column**

Fill missing values in the Model column with "Unknown".

```python
df['Model'] = df['Model'].fillna('Unknown')
```

**Code Example: Fill Missing String Values Using Most Frequent Value (Mode)**

**Often the best choice** for categorical data.

```python
df['Body'] = df['Body'].fillna(df['Body'].mode()[0])
```

**Code Example: Fill Many Categorical Columns With Their Own Mode**

Fill the missing values of all categorical columns of a data frams with their own mode values.

```python
for col in df.select_dtypes(include='object'):
    df[col] = df[col].fillna(df[col].mode()[0])
```

**Print the mode values of each categorical column**

```python
for col in df.select_dtypes(include='object'):
    print(df[col].mode()[0])
```

**output**

```
Volkswagen
sedan
Diesel
yes
E-Class
```

# 10. Add a New Column to a DataFram

## **10.1 Add Column Using Series**
To **add a new column to a DataFrame using a Series**, you can simply **assign the Series to a new column name**. The Series must be the same length as the DataFrame, and its index will automatically align with the DataFrame's index. **For example**, `df['New_Column'] = my_series` will create a new column named '`New_Column`' populated with the values from `my_series`.

**If Series length < DataFrame length → remaining values = NaN.**

### Example

```python
seats = pd.Series([4, 4, 4])
df['Seats'] = seats
print(df['Seats'].head(10))
```

**Output**

```
0    4.0
1    4.0
2    4.0
3    NaN
4    NaN
5    NaN
6    NaN
7    NaN
8    NaN
9    NaN
Name: Seats, dtype: float64
```

## **10.2. Replace NaN in New Column**
After adding a new '`Seats`' column where the Series was shorter than the DataFrame, the **missing values are filled with `NaN`**. We can then **replace these NaN** values in the 'Seats' column using `.fillna(2)`, which will set all the **missing entries to the value 2**.

```python
df['Seats'] = df['Seats'].fillna(2)
print(df['Seats'].head(10))
```

**Output**

```
0    4.0
1    4.0
2    4.0
3    2.0
4    2.0
5    2.0
6    2.0
7    2.0
8    2.0
9    2.0
Name: Seats, dtype: float64
```

## **10.3. Add Column Using Python List**
To add a new column to a DataFrame using a Python list, you can **assign the list directly to a new column name**. The length of the list **must exactly match the number of rows in the DataFrame**; otherwise, **an error will occur**. For example, `df['New_Column'] = my_list` will create the new column and populate it with the values from the list in the order they appear.

**Length of list must match DataFrame length.**

### Example

```python
fuel = [7.5, 6.8, 8.0]
df['Fuel per 100KM'] = fuel
```

**Output**: Since the length of the fuel list **is not equal** to the length of the DataFrame, the code results in a `ValueError`.

## **10.4. Add Column from Other Columns**

You can add a new column to a DataFrame by **performing operations on existing columns**. The new column is created by assigning the result of an expression that references other columns in the DataFrame.

For example, you can create a new column, such as `'Price in Euros'`, by performing an operation on an existing column. For instance, if you have a `'Price'` column in US Dollars and the exchange rate is 0.85, you would use the command `df['Price in Euros'] = df['Price'] * 0.85`. This creates the new column and populates it with the converted values for each row.

```python
# Add a new column 'Price in Euros' by converting from Price (assuming conversion rate 0.85)
df['Price in Euros'] = df['Price'] * 0.85

# View the updated DataFrame
print(df[['Price', 'Price in Euros']].head())
```

**Output**

```
     Price  Price in Euros
0   4200.0          3570.0
1   7900.0          6715.0
2  13300.0         11305.0
3  23000.0         19550.0
4  18300.0         15555.0
```

**In Pandas, you can create a new column by combining values from other columns.**

```python
# Create a new column 'Car Name' by combining Brand and Model
df['Car Name'] = df['Brand'] + ' ' + df['Model']

print(df[['Brand', 'Model', 'Car Name']].head())
```

**Output**

```
           Brand         Model                    Car Name
0            BMW           320                     BMW 320
1  Mercedes-Benz  Sprinter 212  Mercedes-Benz Sprinter 212
2  Mercedes-Benz         S 500         Mercedes-Benz S 500
3           Audi            Q7                     Audi Q7
4         Toyota         Rav 4                Toyota Rav 4
```

# **10.5. Add Column with Same Value**
To add a new column where **every row has the same value**, you can **assign a single value to a new column name**. Pandas will automatically broadcast this value to all rows in the DataFrame. For example, the command `df['Number of wheels'] = 4` will create a new 'Number of wheels' column and fill every row with the number `4`.

```python
df['Number of wheels'] = 4
print(df.head())
```

**Output**

```
           Brand    Price       Body  Mileage  EngineV Engine Type  \
0            BMW   4200.0      sedan      277      2.0      Petrol   
1  Mercedes-Benz   7900.0        van      427      2.9      Diesel   
2  Mercedes-Benz  13300.0      sedan      358      5.0         Gas   
3           Audi  23000.0  crossover      240      4.2      Petrol   
4         Toyota  18300.0  crossover      120      2.0      Petrol   

  Registration  Year         Model  Seats  Price in Euros  \
0          yes  1991           320    4.0          3570.0   
1          yes  1999  Sprinter 212    4.0          6715.0   
2          yes  2003         S 500    4.0         11305.0   
3          yes  2007            Q7    2.0         19550.0   
4          yes  2011         Rav 4    2.0         15555.0   

                     Car Name  Number of wheels  
0                     BMW 320                 4  
1  Mercedes-Benz Sprinter 212                 4  
2         Mercedes-Benz S 500                 4  
3                     Audi Q7                 4  
4                Toyota Rav 4                 4  
```

**Print the column of the Datafram**

```python
print(df.columns)
```

**Output**

```
Index(['Brand', 'Price', 'Body', 'Mileage', 'EngineV', 'Engine Type',
       'Registration', 'Year', 'Model', 'Seats', 'Price in Euros', 'Car Name',
       'Number of wheels'],
      dtype='object')
```

---

# **11. Filtering Rows**

Filtering rows in a DataFrame allows you to **select a subset of data** based on a **specific condition**. This is typically done by placing the conditional statement inside square brackets after the DataFrame. For example, `df[df['Price'] > 10000]` will return all rows where the value in the `'Price'` column is greater than $10,000$.

### Example:

```python
print(df[df['Price']>10000].head())
```

**Output**

```
           Brand     Price       Body  Mileage  EngineV Engine Type  \
2  Mercedes-Benz   13300.0      sedan      358      5.0         Gas   
3           Audi   23000.0  crossover      240      4.2      Petrol   
4         Toyota   18300.0  crossover      120      2.0      Petrol   
5  Mercedes-Benz  199999.0  crossover        0      5.5      Petrol   
7           Audi   14200.0      vagon      200      2.7      Diesel   

  Registration  Year   Model  Seats  Price in Euros              Car Name  \
2          yes  2003   S 500    4.0        11305.00   Mercedes-Benz S 500   
3          yes  2007      Q7    2.0        19550.00               Audi Q7   
4          yes  2011   Rav 4    2.0        15555.00          Toyota Rav 4   
5          yes  2016  GLS 63    2.0       169999.15  Mercedes-Benz GLS 63   
7          yes  2006      A6    2.0        12070.00               Audi A6   

   Number of wheels  
2                 4  
3                 4  
4                 4  
5                 4  
7                 4 
```

### Example: count the number of rows that satisfy the condition

**Using `.len()`**

```python
count = len(df[df['Price'] > 10000])
print(count)
```

**Output**

```
2329
```

**Or using `.sum()`**

```python
count = (df['Price'] > 10000).sum()
print(count
```

**Output**

```
2329
```

**Or using `.count()`**

```python
count = df[df['Price'] > 10000]['Price'].count()
print(count)
```

**Output**

```
2329
```

---

# **12. Summary Table of Pandas Methods**

Below is a complete table summarizing all methods used.

| Method        | Short Description       | Example                   |
| ------------- | ----------------------- | ------------------------- |
| `read_csv()`  | Load CSV file           | `pd.read_csv('file.csv')` |
| `to_csv()`    | Export DataFrame to CSV | `df.to_csv('x.csv')`      |
| `columns`     | Show columns            | `df.columns`              |
| `index`       | Show index              | `df.index`                |
| `info()`      | Show DataFrame info     | `df.info()`               |
| `describe()`  | Summary stats           | `df.describe()`           |
| `head()`      | Top rows                | `df.head(5)`              |
| `tail()`      | Bottom rows             | `df.tail(3)`              |
| `fillna()`    | Replace NaN values      | `df.fillna(0)`            |
| `Series()`    | Create a Series         | `pd.Series([...])`        |
| `DataFrame()` | Create DataFrame        | `pd.DataFrame({...})`     |

